<div class="login-wrapper" role="main">
  <p-card styleClass="login-card">
    <ng-template pTemplate="header">
      <h1 class="login-title">Iniciar sesión</h1>
    </ng-template>
    <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="login-form">
      <div class="form-field">
        <span class="p-float-label">
          <input
            id="username"
            type="text"
            pInputText
            formControlName="username"
            [style]="{ width: '100%' }"
            aria-describedby="username-help"
            maxlength="20"
            autofocus="true"
          />
          <label for="username">Nombre de usuario</label>
        </span>
        @if(!(username?.dirty || username?.touched)) {
          <small id="username-help" class="helper-text">
            Ingrese su nombre de usuario (entre 5 y 20 caracteres)
          </small>
        }
        @if(username?.invalid && (username?.dirty || username?.touched)) {
          <small class="error-message" role="alert">{{ getUsernameError(username!) }}</small>
        }
      </div>
      <div class="form-field">
        <span class="p-float-label">
          <p-password
            id="password"
            formControlName="password"
            [maxLength]="30"
            [toggleMask]="true"
            [style]="{ width: '100%' }"
            [inputStyle]="{ width: '100%' }"
            [feedback]="true"
            [strongRegex]="strongPasswordRegex"
            aria-describedby="password-help"
            (onFocus)="passwordFocus = true"
            (onBlur)="passwordFocus = false"
          ></p-password>
          <label for="password">Contraseña</label>
        </span>
        @if(!(password?.dirty || password?.touched)) {
          <small id="password-help" class="helper-text">
            Ingrese su contraseña (entre 8 y 30 caracteres, incluyendo mayúsculas, minúsculas, números y símbolos)
          </small>
        }
        @if(password?.invalid && (password?.dirty || password?.touched)) {
          <small class="error-message {{ passwordFocus ? 'password-focus' : '' }}" role="alert">{{ getPasswordErrorMessage(password?.value || '') }}</small>
        }
      </div>
      <p-divider></p-divider>
      <p-button
        label="Iniciar sesión"
        type="submit"
        [disabled]="loginForm.invalid"
        styleClass="login-button"
        [loading]="isLoading"
      ></p-button>
    </form>
  </p-card>
</div>
